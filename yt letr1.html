<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>Enhanced Responsive Love Letter</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400..700&family=Sacramento&display=swap"
      rel="stylesheet" />
    <style>
      /* --- 1. ENHANCED VARIABLES & BASE STYLES --- */
      :root{ 
          --accent:#e34c95; /* Deep Pink */
          --bg1:#ff9a9e; 
          --bg2:#fecfef; 
          --wax-seal: #a72323; 
          --letter-color: #3a2a69; 
      }
      /* Ensure full height and remove default margins */
      html,body{ height:100%; margin:0; font-family:-apple-system,BlinkMacSystemFont, 'Segoe UI', Roboto, Arial; }
      body{ 
          display:flex; 
          flex-direction: column;
          align-items:center; 
          justify-content:center; 
          min-height: 100vh; /* Use min-height for full screen on mobile */
          background: linear-gradient(135deg,var(--bg1) 0%,var(--bg2) 100%); 
          padding: 20px; /* Add padding for better spacing on edges */
          box-sizing: border-box;
      }
      
      /* --- 2. ENVELOPE CONTAINER & 3D SETUP --- */
      .envlope-wrapper{ 
          width:92%; /* Use percentage for flexible width */
          max-width:780px; 
          display:flex; 
          align-items:center; 
          justify-content:center; 
      }
      #envelope{ 
          width:90vw; /* Use viewport width for envelope size */
          max-width:420px;
          height: 55vw; 
          max-height:260px;
          position:relative; 
          perspective:1000px; 
          cursor: pointer;
      }
      
      /* --- 3. ENVELOPE PARTS (FRONT & POCKET) --- */
      .front{ 
          position:absolute; 
          width:100%; 
          height:100%; 
          left:0; 
          top:0; 
          border-radius:12px; 
          box-shadow:0 18px 50px rgba(0,0,0,0.2); 
          overflow:hidden; 
          transition: box-shadow 0.5s ease-in-out;
      }
      .front.pocket{ 
          /* Subtle paper texture */
          background: repeating-linear-gradient(135deg,#e4c0c0,#ffffff 5px,#fff6fa 5px,#fff6fa 10px);
          transform: translateY(8px); 
          z-index: 5;
      }
      .front.flap{ 
          transform-origin: top; 
          background: linear-gradient(180deg,#fff,#ffd0ea); 
          height:72%; 
          z-index:6; 
          border-bottom: 2px solid rgba(255, 215, 0, 0.4); 
      }

      /* --- 4. WAX SEAL EFFECT --- */
      .front.flap::after {
          content: 'ðŸ’Œ'; 
          position: absolute;
          bottom: 0;
          left: 50%;
          transform: translate(-50%, 50%);
          font-size: 28px;
          z-index: 7;
          opacity: 0.9;
          transition: opacity 700ms;
      }
      #envelope.open .front.flap::after {
          opacity: 0; 
      }
      
      /* --- 5. OPEN ANIMATION --- */
      #envelope.open .front.flap{ 
          transform: rotateX(180deg) translateY(-10%); 
          transition: transform 900ms cubic-bezier(.2,.9,.2,1); 
      }
      #envelope .letter{ 
          position:absolute; 
          left:22px; 
          right:22px; 
          top:30px; 
          bottom:22px; 
          background:white; 
          border-radius:8px; 
          padding:25px 30px; 
          transform: translateY(0) scale(1); 
          opacity:0; 
          transition: transform 900ms cubic-bezier(.2,.9,.2,1), opacity 300ms 600ms; 
          /* Letter content display properties */
          display:flex; flex-direction:column; align-items:flex-start; justify-content:center;
      }
      #envelope.open .letter{ 
          transform: translateY(-55px) scale(1.02); 
          opacity:1; 
      }
      #envelope.close .letter{ 
          transform: translateY(12px) scale(0.98); 
          opacity:0; 
      }

      /* --- 6. LETTER CONTENT STYLES --- */
      .words{ 
          font-family:'Dancing Script', cursive; 
          color:var(--letter-color); 
          font-size: 20px; 
          margin:6px 0; 
          line-height: 1.4;
      }
      .words.line1 { 
          font-family: 'Sacramento', cursive; 
          font-size: 32px; 
          font-weight: 400; 
          margin-bottom: 18px;
          color: var(--wax-seal); 
          align-self: center;
      }
      .words.line5 { 
          margin-top: 30px; 
          font-size: 22px; 
          align-self: flex-end; 
      }
      
      /* --- 7. NOTIFICATION BAR --- */
      #notification {
          position: fixed;
          top: 0;
          left: 50%;
          transform: translateX(-50%);
          background: rgba(0, 0, 0, 0.7);
          color: white;
          padding: 10px 20px;
          border-radius: 0 0 8px 8px;
          opacity: 0;
          transition: opacity 0.5s ease-out;
          pointer-events: none;
          z-index: 100;
          font-weight: bold;
      }

      /* --- 8. CONTROLS --- */
      .reset{ 
          display:flex; 
          gap:10px; 
          position:static; /* Use static positioning for better flow on small screens */
          margin-top: 20px;
          flex-wrap: wrap;
          justify-content: center;
          z-index: 10; 
      }
      .reset button, .reset a.btn { 
          padding:10px 16px; 
          border-radius:10px; 
          border:0; 
          background:var(--accent); 
          color:#fff; 
          font-weight:700; 
          cursor:pointer; 
          transition: background 200ms, transform 100ms;
          text-decoration: none;
          flex-shrink: 0;
      }
      .reset button:hover, .reset a.btn:hover {
          background: #ff5ca8;
          transform: translateY(-2px);
      }
      
      /* --- 9. MOBILE SPECIFIC MEDIA QUERY --- */
      /* This ensures the envelope and text shrink appropriately on very small screens */
      @media (max-width:480px){ 
          .words{ font-size:16px; } 
          .words.line1 { font-size: 26px; }
          .words.line5 { font-size: 18px; }
          .reset { gap: 8px; }
          .reset button, .reset a.btn { padding: 8px 12px; font-size: 14px; }
      }
    </style>
  </head>
  <body>
    <div id="notification">You've Got Mail! ðŸ’Œ</div>

    <div class="envlope-wrapper">
      <div id="envelope" class="close">
        
        <div class="front flap"></div>
        
        <div class="front pocket"></div>
        
        <div class="letter">
          <div class="words line1">To My Dearest Love,</div>
          <div class="words line2">Happy birthday, my love! I hope your day is filled</div>
          <div class="words line3">with as much joy as you bring into my life every single day.</div>
          <div class="words line4">May you have many more wonderful birthdays to come. Remember that I love you so much, and I miss you too!</div>
          <div class="words line5">Yours Always,</div>
        </div>
        
        <div class="hearts">
          <div class="heart a1"></div>
          <div class="heart a2"></div>
          <div class="heart a3"></div>
        </div>
      </div>
    </div>
    
    <div class="reset">
      <button id="open" aria-expanded="false" aria-controls="envelope">Open Letter</button>
      <button id="resetBtn">Close</button>
      <a class="btn" href="web mark 1.html" style="background: #764ba2;">Back to Page 1</a>
      <a class="btn" href="page2.html" style="background: #e34c95;">Back to Question</a>
    </div>
    
    <canvas id="confettiCanvas" aria-hidden="true" style="position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:9999;"></canvas>
    
    <script>
      (function(){
        const env = document.getElementById('envelope');
        const openBtn = document.getElementById('open');
        const resetBtn = document.getElementById('resetBtn');
        const notification = document.getElementById('notification');
        
        function showNotification() {
            notification.classList.add('show');
            setTimeout(() => {
                notification.classList.remove('show');
            }, 2000);
        }

        function toggle(open){ 
            if(open){ 
                env.classList.remove('close'); 
                env.classList.add('open'); 
                showNotification(); 
            } else { 
                env.classList.remove('open'); 
                env.classList.add('close'); 
            }
        }

        // --- Confetti JS (Unchanged Physics Simulation) ---
        const canvas = document.getElementById('confettiCanvas');
        const ctx = canvas.getContext && canvas.getContext('2d'); 
        if(!ctx) return; 

        function setSize(){ canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        window.addEventListener('resize', setSize); 
        setSize();
        
        const particles = [];
        function rand(min,max){ return Math.random()*(max-min)+min; }
        
        function Particle(x,y,dx,dy,size,color){ 
            this.x=x;this.y=y;this.dx=dx;this.dy=dy;this.size=size;this.color=color; 
        }

        Particle.prototype.update = function(dt){ 
            this.x += this.dx * dt; 
            this.y += this.dy * dt; 
            this.dy += 0.0015 * dt; 
        }

        Particle.prototype.draw = function(ctx){ 
            ctx.fillStyle = this.color; 
            ctx.fillRect(this.x, this.y, this.size, this.size); 
        }

        function createBurst(x,y,count){ 
            const colors=['#FF5CA8','#FFB86B','#FFD166','#7AE7C7','#7EA9FF','#D28BFF']; 
            for(let i=0;i<count;i++){ 
                const angle=rand(0,Math.PI*2); 
                const speed=rand(0.6,3.5); 
                const dx=Math.cos(angle)*speed; 
                const dy=Math.sin(angle)*speed*-1.2; 
                const size=Math.floor(rand(6,14)); 
                const color=colors[Math.floor(rand(0,colors.length))]; 
                particles.push(new Particle(x + rand(-10,10), y + rand(-10,10), dx, dy, size, color)); 
            }
        }
        
        let last = performance.now(); 
        let running=false;

        function animate(now){ 
            const dt=Math.min(50, now-last); 
            last=now; 
            ctx.clearRect(0,0,canvas.width, canvas.height); 
            
            for(let i=particles.length-1;i>=0;i--){ 
                const p=particles[i]; 
                p.update(dt); 
                p.draw(ctx); 
                if(p.y - p.size > canvas.height + 50 || p.x < -50 || p.x > canvas.width + 50) 
                    particles.splice(i,1); 
            } 
            
            if(particles.length>0) 
                requestAnimationFrame(animate); 
            else 
                running=false; 
        }

        function triggerBurst(x,y,count){ 
            createBurst(x,y,count); 
            if(!running){ 
                running=true; 
                last=performance.now(); 
                requestAnimationFrame(animate);
            } 
        }
        
        // Event Listeners: Click envelope anywhere to open
        env.addEventListener('click', function(e){
            if (env.classList.contains('close')) {
                toggle(true);
                // Burst where the user clicks
                triggerBurst(e.clientX, e.clientY, 100); 
                openBtn.setAttribute('aria-expanded', 'true'); 
            }
        });
        
        // Event Listeners for Buttons (fallbacks)
        openBtn.addEventListener('click', function(e){ 
            toggle(true); 
            triggerBurst(window.innerWidth/2, window.innerHeight/3, 80); 
            openBtn.setAttribute('aria-expanded', 'true'); 
        });
        
        resetBtn.addEventListener('click', function(){ 
            toggle(false); 
            openBtn.setAttribute('aria-expanded', 'false'); 
        });

      })();
    </script>
  </body>
</html>